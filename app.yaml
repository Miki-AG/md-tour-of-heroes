runtime: python27
api_version: 1
threadsafe: true

# Changed from F1 to B1
# instance_class: B1
# basic_scaling:
#   max_instances: 1
#   idle_timeout: 10m

libraries:
# - name: pycrypto
#   version: latest
# - name: endpoints
#   version: 1.0
# - name: ssl
#   version: latest
- name: pycrypto
  version: 2.6
- name: ssl
  version: 2.7.11

# gcloud endpoints services deploy openapi.yaml
# https://developers.google.com/apis-explorer/?base=https://ng-md-gae-boilerplate.appspot.com/_ah/api#p/
env_variables:
  # The following values are to be replaced by information from the output of
  # 'gcloud endpoints services deploy swagger.json' command.
  ENDPOINTS_SERVICE_NAME: ng-md-gae-boilerplate.appspot.com
  ENDPOINTS_SERVICE_VERSION: 2018-07-05r2

handlers:
- url: /static
  static_dir: static

- url: /((?:main|polyfills|styles|vendor|runtime)(?:\.[a-z0-9]*)?(?:\.js)?(?:\.css)?(?:\.map)?)
  secure: always
  redirect_http_response_code: 301
  static_files: dist/\1
  upload: dist/.*
  application_readable: true

# url below must be /_ah/spi/.*
# although the calls are like
# /_ah/api/.*
# - url: /_ah/spi/.*
#   secure: always
#   script: server.api.application

- url: /_ah/api/.*
  secure: always
  script: server.api.application

- url: /.*
  secure: always
  script: server.backend.application

skip_files:
- ^(.*/)?.*/angular_material_schematics*/.*$
- ^(.*/)?.*/e2e/.*$
- ^(.*/)?.*/node_modules/.*$
- ^node_modules$
- ^.git